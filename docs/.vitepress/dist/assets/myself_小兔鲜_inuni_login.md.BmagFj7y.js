import{_ as s,c as i,a2 as a,o as l}from"./chunks/framework.DN5Ma_nw.js";const g=JSON.parse('{"title":"登录","description":"","frontmatter":{},"headers":[],"relativePath":"myself/小兔鲜/inuni/login.md","filePath":"project/myself/小兔鲜/inuni/login.md","lastUpdated":1733132188000}'),e={name:"myself/小兔鲜/inuni/login.md"};function n(h,t,p,k,d,r){return l(),i("div",null,t[0]||(t[0]=[a(`<h1 id="登录" tabindex="-1">登录 <a class="header-anchor" href="#登录" aria-label="Permalink to &quot;登录&quot;">​</a></h1><h2 id="手机快捷登录" tabindex="-1">手机快捷登录 <a class="header-anchor" href="#手机快捷登录" aria-label="Permalink to &quot;手机快捷登录&quot;">​</a></h2><p>在真实的业务场景中，微信手机号快捷登录的步骤为：</p><ol><li>通过 <code>uni.login</code> 获取到用户的 <code>code</code></li><li>修改按钮类型，通过 <code>getphonenumber</code> 方法获取用户的 <code>iv</code> 与 <code>encryptedData</code> 等信息，根据后端接口文档给出的信息实现</li><li>调接口传参，实现登录</li></ol><p>代码如下所示：</p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setup</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lang</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { loginApi } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/services/login&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { onLoad } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@dcloudio/uni-app&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 获取 code 登录凭证</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> code </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onLoad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  uni.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">login</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    code </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> res.code</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 获取用户手机号码</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onGetPhoneNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UniHelper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ButtonOnGetphonenumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> encryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ev.detail</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.encryptedData</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ev.detail</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  loginApi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    code,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    encryptedData,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    iv,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(res)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">view</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;viewport&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">view</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;login&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> open-type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;getPhoneNumber&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @getphonenumber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;onGetPhoneNumber&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;button phone&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">text</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;icon icon-phone&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        手机号快捷登录</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">view</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">view</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h2 id="open-type-有效值" tabindex="-1">open-type 有效值 <a class="header-anchor" href="#open-type-有效值" aria-label="Permalink to &quot;open-type 有效值&quot;">​</a></h2><p><code>uniapp</code> 中按钮组件通过 <code>open-type</code> 属性可以设置当前按钮的作用，可用属性如下：</p><table tabindex="0"><thead><tr><th style="text-align:left;">值</th><th style="text-align:left;">说明</th><th style="text-align:left;">平台差异说明</th></tr></thead><tbody><tr><td style="text-align:left;">feedback</td><td style="text-align:left;">打开“意见反馈”页面，用户可提交反馈内容并上传日志</td><td style="text-align:left;">App、微信小程序、QQ小程序</td></tr><tr><td style="text-align:left;">share</td><td style="text-align:left;">触发用户转发</td><td style="text-align:left;">微信小程序、百度小程序、支付宝小程序、抖音小程序、飞书小程序、QQ小程序、快手小程序、京东小程序、360小程序</td></tr><tr><td style="text-align:left;">getUserInfo</td><td style="text-align:left;">获取用户信息，可以从@getuserinfo回调中获取到用户信息</td><td style="text-align:left;">微信小程序、百度小程序、QQ小程序、快手小程序、京东小程序、360小程序</td></tr><tr><td style="text-align:left;">contact</td><td style="text-align:left;">打开客服会话，如果用户在会话中点击消息卡片后返回应用，可以从 @contact 回调中获得具体信息</td><td style="text-align:left;">微信小程序、百度小程序、快手小程序、抖音小程序</td></tr><tr><td style="text-align:left;">getPhoneNumber</td><td style="text-align:left;">获取用户手机号，可以从@getphonenumber回调中获取到用户信息</td><td style="text-align:left;">微信小程序、百度小程序、抖音小程序、支付宝小程序、快手小程序、京东小程序。App平台另见<a href="https://uniapp.dcloud.net.cn/univerify" target="_blank" rel="noreferrer">一键登陆</a></td></tr><tr><td style="text-align:left;">launchApp</td><td style="text-align:left;">小程序中打开APP，可以通过app-parameter属性设定向APP传的参数</td><td style="text-align:left;"><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/launchApp.html" target="_blank" rel="noreferrer">微信小程序</a>、<a href="https://q.qq.com/wiki/develop/miniprogram/frame/open_ability/open_app.html" target="_blank" rel="noreferrer">QQ小程序</a>、快手小程序、京东小程序</td></tr><tr><td style="text-align:left;">openSetting</td><td style="text-align:left;">打开授权设置页</td><td style="text-align:left;">微信小程序、QQ小程序、百度小程序、快手小程序、京东小程序、360小程序</td></tr><tr><td style="text-align:left;">chooseAvatar</td><td style="text-align:left;">获取用户头像，可以从@chooseavatar回调中获取到头像信息</td><td style="text-align:left;">微信小程序2.21.2版本+</td></tr><tr><td style="text-align:left;">uploadDouyinVideo</td><td style="text-align:left;">发布抖音视频</td><td style="text-align:left;">抖音小程序2.65.0版本+</td></tr><tr><td style="text-align:left;">im</td><td style="text-align:left;">跳转到抖音IM客服</td><td style="text-align:left;">抖音小程序2.80.0版本+</td></tr><tr><td style="text-align:left;">getAuthorize</td><td style="text-align:left;">支持小程序授权</td><td style="text-align:left;">支付宝小程序</td></tr><tr><td style="text-align:left;">lifestyle</td><td style="text-align:left;">关注生活号</td><td style="text-align:left;">支付宝小程序</td></tr><tr><td style="text-align:left;">contactShare</td><td style="text-align:left;">分享到通讯录好友</td><td style="text-align:left;">支付宝小程序基础库1.11.0版本+</td></tr><tr><td style="text-align:left;">openGroupProfile</td><td style="text-align:left;">呼起QQ群资料卡页面，可以通过group-id属性设定需要打开的群资料卡的群号，同时manifest.json中必须配置groupIdList</td><td style="text-align:left;">QQ小程序基础库1.4.7版本+</td></tr><tr><td style="text-align:left;">openGuildProfile</td><td style="text-align:left;">呼起频道页面，可以通过guild-id属性设定需要打开的频道ID</td><td style="text-align:left;">QQ小程序基础库1.46.8版本+</td></tr><tr><td style="text-align:left;">openPublicProfile</td><td style="text-align:left;">打开公众号资料卡，可以通过public-id属性设定需要打开的公众号资料卡的号码，同时manifest.json中必须配置publicIdList</td><td style="text-align:left;">QQ小程序基础库1.12.0版本+</td></tr><tr><td style="text-align:left;">shareMessageToFriend</td><td style="text-align:left;">在自定义开放数据域组件中,向指定好友发起分享据</td><td style="text-align:left;">QQ小程序基础库1.17.0版本+</td></tr><tr><td style="text-align:left;">addFriend</td><td style="text-align:left;">添加好友， 对方需要通过该小程序进行授权，允许被加好友后才能调用成功用户授权</td><td style="text-align:left;">QQ小程序</td></tr><tr><td style="text-align:left;">addColorSign</td><td style="text-align:left;">添加彩签，点击后添加状态有用户提示，无回调</td><td style="text-align:left;">QQ小程序基础库1.10.0版本+</td></tr><tr><td style="text-align:left;">addGroupApp</td><td style="text-align:left;">添加群应用（只有管理员或群主有权操作），添加后给button绑定@addgroupapp事件接收回调数据</td><td style="text-align:left;">QQ小程序基础库1.16.0版本+</td></tr><tr><td style="text-align:left;">addToFavorites</td><td style="text-align:left;">收藏当前页面，点击按钮后会触发Page.onAddToFavorites方法</td><td style="text-align:left;">QQ小程序基础库1.19.0版本+</td></tr><tr><td style="text-align:left;">chooseAddress</td><td style="text-align:left;">选择用户收货地址，可以从@chooseaddress回调中获取到用户选择的地址信息</td><td style="text-align:left;">百度小程序3.160.3版本+</td></tr><tr><td style="text-align:left;">chooseInvoiceTitle</td><td style="text-align:left;">选择用户发票抬头，可以从@chooseinvoicetitle回调中获取到用户选择发票抬头信息</td><td style="text-align:left;">百度小程序3.160.3版本+</td></tr><tr><td style="text-align:left;">login</td><td style="text-align:left;">登录，可以从@login回调中确认是否登录成功</td><td style="text-align:left;">百度小程序3.230.1版本+</td></tr><tr><td style="text-align:left;">subscribe</td><td style="text-align:left;">订阅类模板消息，需要用户授权才可发送</td><td style="text-align:left;">百度小程序</td></tr><tr><td style="text-align:left;">favorite</td><td style="text-align:left;">触发用户收藏</td><td style="text-align:left;">快手小程序</td></tr><tr><td style="text-align:left;">watchLater</td><td style="text-align:left;">触发用户稍后再看</td><td style="text-align:left;">快手小程序</td></tr><tr><td style="text-align:left;">openProfile</td><td style="text-align:left;">触发打开用户主页</td><td style="text-align:left;">快手小程序</td></tr></tbody></table><p>设置了 <code>getPhoneNumber</code> 后可以通过 <code>@getphonenumber</code> 方法获取用户手机号等信息。</p>`,10)]))}const y=s(e,[["render",n]]);export{g as __pageData,y as default};
