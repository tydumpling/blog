import{_ as a,c as n,a2 as i,o as p}from"./chunks/framework.DN5Ma_nw.js";const c=JSON.parse('{"title":"fs","description":"","frontmatter":{},"headers":[],"relativePath":"TypeScript/fs.md","filePath":"learn/Node/fs.md","lastUpdated":1733132188000}'),t={name:"TypeScript/fs.md"};function l(e,s,h,r,k,o){return p(),n("div",null,s[0]||(s[0]=[i(`<h1 id="fs" tabindex="-1">fs <a class="header-anchor" href="#fs" aria-label="Permalink to &quot;fs&quot;">​</a></h1><p>fs 模块是 Node.js 官方提供的、用来操作文件的模块。它提供了一系列的方法和属性，用来满足用户对文件的操作需求。下面来一一介绍。</p><h2 id="异步操作" tabindex="-1">异步操作 <a class="header-anchor" href="#异步操作" aria-label="Permalink to &quot;异步操作&quot;">​</a></h2><p>我们使用 <code>readFile</code> 与 <code>writeFile</code> 对文件进行异步读写操作</p><p>同步文件操作会阻塞进程，所以使用异步文件操作拥有更好的性能，也是推荐的做法。</p><h3 id="读取文件" tabindex="-1">读取文件 <a class="header-anchor" href="#读取文件" aria-label="Permalink to &quot;读取文件&quot;">​</a></h3><p>使用 <code>fs.readFile()</code> 方法，可以读取指定文件中的内容，语法格式如下：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(path[, options], callback)</span></span></code></pre></div><ul><li>参数 1：必选参数，字符串，表示文件的路径。</li><li>参数 2：可选参数，表示以什么编码格式来读取文件。</li><li>参数 3：必选参数，文件读取完成后，通过回调函数拿到读取的结果</li></ul><h4 id="示例代码" tabindex="-1">示例代码 <a class="header-anchor" href="#示例代码" aria-label="Permalink to &quot;示例代码&quot;">​</a></h4><p><code>1.txt</code> 文件内容：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>hello</span></span></code></pre></div><p><code>index.js</code> 文件内容：</p><ul><li><p>成功情况</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./1.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dataStr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dataStr); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// hello</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li><li><p>失败情况</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./11.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dataStr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //	errno: -4058,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //	code: &#39;ENOENT&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //	syscall: &#39;open&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //	path: &#39;C:\\\\Users\\\\Administrator\\\\Desktop\\\\blog\\\\node\\\\11.txt&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dataStr); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// undefined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li></ul><h3 id="写入文件" tabindex="-1">写入文件 <a class="header-anchor" href="#写入文件" aria-label="Permalink to &quot;写入文件&quot;">​</a></h3><p>使用 <code>fs.writeFile()</code> 方法，可以向指定的文件中写入内容，语法格式如下：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">writeFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(file, data[, options], callback)</span></span></code></pre></div><ul><li>参数 1：必选参数，需要指定一个文件路径的字符串，表示文件的存放路径。</li><li>参数 2：必选参数，表示要写入的内容。</li><li>参数 3：可选参数，表示以什么格式写入文件内容，默认值是 utf8。</li><li>参数 4：必选参数，文件写入完成后的回调函数</li></ul><h4 id="示例代码-1" tabindex="-1">示例代码 <a class="header-anchor" href="#示例代码-1" aria-label="Permalink to &quot;示例代码&quot;">​</a></h4><ul><li><p>成功状态</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">writeFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./1.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;add&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li><li><p>失败状态</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">writeFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./11.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;add&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //  errno: -4058,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //  code: &#39;ENOENT&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //  syscall: &#39;open&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //  path: &#39;C:\\\\Users\\\\Administrator\\\\Desktop\\\\blog\\\\abc\\\\1.txt&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li></ul><h3 id="案例" tabindex="-1">案例 <a class="header-anchor" href="#案例" aria-label="Permalink to &quot;案例&quot;">​</a></h3><p>使用 <code>fs</code> 文件系统模块，将素材目录下成绩 <code>.txt</code> 文件中的考试数据，整理到成绩 <code>ok.txt</code> 文件中。</p><p>整理前的格式：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>小红=99 小白=100 tydumpling=150 小李=50</span></span></code></pre></div><p>整理后的格式：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>小红：99</span></span>
<span class="line"><span>小白：100</span></span>
<span class="line"><span>tydumpling：150</span></span>
<span class="line"><span>小李：50</span></span></code></pre></div><p>代码：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./1.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dataStr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 判断读取是否成功</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (err) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;读取文件失败，&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, err);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 把获取到的字符串中的 = 正则替换为：，空格替换为换行</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> arr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dataStr.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">g</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;：&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">g</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\r\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  fs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">writeFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./2.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, arr, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 判断写入是否成功</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (err) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;成绩写入失败&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;成绩写入成功&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h2 id="同步操作" tabindex="-1">同步操作 <a class="header-anchor" href="#同步操作" aria-label="Permalink to &quot;同步操作&quot;">​</a></h2><ul><li>同步操作会阻塞进程</li><li>如果是写入文件，可以不设置编码</li></ul><h3 id="回调函数" tabindex="-1">回调函数 <a class="header-anchor" href="#回调函数" aria-label="Permalink to &quot;回调函数&quot;">​</a></h3><p>使用 <strong>readFile</strong> 与 <strong>writeFile</strong> 可以对文件进行异步操作，不阻塞进程拥有更好的性能。</p><ul><li>Node.js 以错误优先为思想，所以回调函数第一个参数为错误信息，没有错误时值为 null</li></ul><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { readFile, writeFile } from &#39;fs&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>readFile(&#39;hd.txt&#39;, &#39;utf8&#39;, (error, content) =&gt; {</span></span>
<span class="line"><span>  if (error) {</span></span>
<span class="line"><span>    console.log(error)</span></span>
<span class="line"><span>  } else {</span></span>
<span class="line"><span>    console.log(content)</span></span>
<span class="line"><span>    //异步写入文件</span></span>
<span class="line"><span>    writeFile(&#39;xj.txt&#39;, content, (error) =&gt; {</span></span>
<span class="line"><span>      if (error) console.log(error)</span></span>
<span class="line"><span>      else console.log(&#39;文件写入成功&#39;)</span></span>
<span class="line"><span>    })</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>})</span></span>
<span class="line"><span>console.log(&#39;后盾人提示，因为是异步，所以这行较readFile的回调函数先执行&#39;)</span></span></code></pre></div><h3 id="promise" tabindex="-1">Promise <a class="header-anchor" href="#promise" aria-label="Permalink to &quot;Promise&quot;">​</a></h3><p>下面使用 Promise 对文件的操作方法进行封装</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { readFile, writeFile } from &#39;fs&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//获取文件</span></span>
<span class="line"><span>function fileGetContent(file: string): Promise&lt;string&gt; {</span></span>
<span class="line"><span>  return new Promise((resolve) =&gt; {</span></span>
<span class="line"><span>    readFile(file, &#39;utf8&#39;, (error, content) =&gt; {</span></span>
<span class="line"><span>      resolve(content)</span></span>
<span class="line"><span>    })</span></span>
<span class="line"><span>  })</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//写入文件</span></span>
<span class="line"><span>function filePutContent(file: string, content: string) {</span></span>
<span class="line"><span>  return new Promise((resolve) =&gt; {</span></span>
<span class="line"><span>    writeFile(file, content, (error) =&gt; {</span></span>
<span class="line"><span>      if (error) throw error</span></span>
<span class="line"><span>      resolve(true)</span></span>
<span class="line"><span>    })</span></span>
<span class="line"><span>  })</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 使用 async/await 使用代码更清晰</span></span>
<span class="line"><span>async function hd() {</span></span>
<span class="line"><span>  const content = await fileGetContent(&#39;hd.txt&#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  await filePutContent(&#39;xj.txt&#39;, content)</span></span>
<span class="line"><span>  console.log(&#39;xj.txt 写入成功&#39;)</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>hd()</span></span>
<span class="line"><span>console.log(&#39;先输出...&#39;)</span></span></code></pre></div><h4 id="fs-promises" tabindex="-1">fs/promises <a class="header-anchor" href="#fs-promises" aria-label="Permalink to &quot;fs/promises&quot;">​</a></h4><p>其实我们不需要自己封装，因为 Node 提供了 Promise 操作机制</p><p><strong>fs/promises</strong> 提供了 Promise 操作机制</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { readFile } from &#39;fs/promises&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>readFile(&#39;hd.txt&#39;, &#39;utf-8&#39;).then((content) =&gt; {</span></span>
<span class="line"><span>  console.log(content)</span></span>
<span class="line"><span>}).catch(error=&gt;console.log(error))</span></span></code></pre></div><h2 id="路径拼接" tabindex="-1">路径拼接 <a class="header-anchor" href="#路径拼接" aria-label="Permalink to &quot;路径拼接&quot;">​</a></h2><p>在使用 <code>fs</code> 模块操作文件时，如果提供的操作路径是以 <code>./</code> 或 <code>../</code> 开头的相对路径时，很容易出现路径动态拼接错误的问题。</p><p>原因：代码在运行的时候，会以执行 <code>node</code> 命令时所处的目录，动态拼接出被操作文件的完整路径。</p><p>解决方案：在使用 <code>fs</code> 模块操作文件时，直接提供完整的路径，或者通过 <code>__dirname</code> 字段拼接获取路径，不要提供 <code>./</code> 或 <code>../</code> 开头的相对路径，从而防止路径动态拼接的问题。</p><h2 id="文件信息" tabindex="-1">文件信息 <a class="header-anchor" href="#文件信息" aria-label="Permalink to &quot;文件信息&quot;">​</a></h2><h3 id="existssync" tabindex="-1">existsSync <a class="header-anchor" href="#existssync" aria-label="Permalink to &quot;existsSync&quot;">​</a></h3><p>使用 <strong>existsSync</strong> 判断文件或目录是否存在，返回值是 <strong>boolean</strong></p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { existsSync } from &#39;fs&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (existsSync(&#39;hd.txt&#39;)) {</span></span>
<span class="line"><span>  console.log(&#39;文件存在&#39;)</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="https-doc-houdunren-com-系统课程-node-8-fs-模块-html-stat-stat" tabindex="-1">[#](<a href="https://doc.houdunren.com/%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B/node/8" target="_blank" rel="noreferrer">https://doc.houdunren.com/系统课程/node/8</a> FS 模块.html#stat)stat <a class="header-anchor" href="#https-doc-houdunren-com-系统课程-node-8-fs-模块-html-stat-stat" aria-label="Permalink to &quot;[#](https://doc.houdunren.com/系统课程/node/8 FS 模块.html#stat)stat&quot;">​</a></h3><p>使用 <strong>stat</strong> 可以获取文件或目录详细信息，比如可用来判断是否是文件或目录。</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { stat } from &#39;fs&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>stat(&#39;hda&#39;, (error, stats) =&gt; {</span></span>
<span class="line"><span>  if (error) throw new Error(&#39;文件不存在或没有操作权限&#39;)</span></span>
<span class="line"><span>  if (stats.isFile()) {</span></span>
<span class="line"><span>    console.log(&#39;这是文件&#39;)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  if (stats.isDirectory()) {</span></span>
<span class="line"><span>    console.log(&#39;这是目录&#39;)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>})</span></span></code></pre></div><p><strong>fs/promises</strong> 提供了 Promise 的操作方法</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { stat } from &#39;fs/promises&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//是否是目录</span></span>
<span class="line"><span>async function fileType(file: string) {</span></span>
<span class="line"><span>  try {</span></span>
<span class="line"><span>    const stats = await stat(file)</span></span>
<span class="line"><span>    return stats.isDirectory() ? &#39;dir&#39; : &#39;file&#39;</span></span>
<span class="line"><span>  } catch (error) {</span></span>
<span class="line"><span>    if (error) throw new Error(&#39;文件不存在或没有操作权限&#39;)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>fileType(&#39;hd&#39;).then((type) =&gt; {</span></span>
<span class="line"><span>  console.log(type === &#39;dir&#39; ? &#39;目录&#39; : &#39;文件&#39;)</span></span>
<span class="line"><span>})</span></span></code></pre></div><h3 id="https-doc-houdunren-com-系统课程-node-8-fs-模块-html-unlink-unlink" tabindex="-1">[#](<a href="https://doc.houdunren.com/%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B/node/8" target="_blank" rel="noreferrer">https://doc.houdunren.com/系统课程/node/8</a> FS 模块.html#unlink)unlink <a class="header-anchor" href="#https-doc-houdunren-com-系统课程-node-8-fs-模块-html-unlink-unlink" aria-label="Permalink to &quot;[#](https://doc.houdunren.com/系统课程/node/8 FS 模块.html#unlink)unlink&quot;">​</a></h3><p>使用 <strong>unlink</strong> 执行异步删除文件</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { unlink, writeFileSync } from &#39;fs&#39;</span></span>
<span class="line"><span>writeFileSync(&#39;hd.txt&#39;, &#39;houdunren&#39;)</span></span>
<span class="line"><span>setTimeout(() =&gt; {</span></span>
<span class="line"><span>	//三秒后删除文件</span></span>
<span class="line"><span>  unlink(&#39;hd.txt&#39;, (error) =&gt; {</span></span>
<span class="line"><span>    if (error) throw error</span></span>
<span class="line"><span>    console.log(&#39;文件删除成功&#39;)</span></span>
<span class="line"><span>  })</span></span>
<span class="line"><span>}, 3000)</span></span></code></pre></div><p><strong>fs/promises</strong> 中封装了 Promise 删除文件方法</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { writeFileSync } from &#39;fs&#39;</span></span>
<span class="line"><span>import { unlink } from &#39;fs/promises&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>async function hd() {</span></span>
<span class="line"><span>  await unlink(&#39;hd.txt&#39;)</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>writeFileSync(&#39;hd.txt&#39;, &#39;houdunren.com&#39;)</span></span>
<span class="line"><span>setTimeout(() =&gt; {</span></span>
<span class="line"><span>  hd()</span></span>
<span class="line"><span>}, 3000)</span></span></code></pre></div><h2 id="https-doc-houdunren-com-系统课程-node-8-fs-模块-html-目录管理-目录管理" tabindex="-1">[#](<a href="https://doc.houdunren.com/%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B/node/8" target="_blank" rel="noreferrer">https://doc.houdunren.com/系统课程/node/8</a> FS 模块.html#目录管理)目录管理 <a class="header-anchor" href="#https-doc-houdunren-com-系统课程-node-8-fs-模块-html-目录管理-目录管理" aria-label="Permalink to &quot;[#](https://doc.houdunren.com/系统课程/node/8 FS 模块.html#目录管理)目录管理&quot;">​</a></h2><p>下面向军大叔教大家使用 Node 操作目录</p><h3 id="https-doc-houdunren-com-系统课程-node-8-fs-模块-html-创建目录-创建目录" tabindex="-1">[#](<a href="https://doc.houdunren.com/%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B/node/8" target="_blank" rel="noreferrer">https://doc.houdunren.com/系统课程/node/8</a> FS 模块.html#创建目录)创建目录 <a class="header-anchor" href="#https-doc-houdunren-com-系统课程-node-8-fs-模块-html-创建目录-创建目录" aria-label="Permalink to &quot;[#](https://doc.houdunren.com/系统课程/node/8 FS 模块.html#创建目录)创建目录&quot;">​</a></h3><p>下面是使用 <strong>mkdirSync</strong> 以同步的方式创建多级目录</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { mkdirSync } from &#39;fs&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const state = mkdirSync(&#39;a/b/c/d&#39;, { recursive: true })</span></span>
<span class="line"><span>if (state) {</span></span>
<span class="line"><span>  console.log(&#39;目录创建成功&#39;)</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>使用 <strong>mkdir</strong> 可以创建目录，如果目录已经存在将报错</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { mkdir } from &#39;fs&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>mkdir(&#39;hd&#39;, (error) =&gt; {</span></span>
<span class="line"><span>  if (error) throw error</span></span>
<span class="line"><span>  console.log(&#39;目录创建成功&#39;)</span></span>
<span class="line"><span>})</span></span></code></pre></div><p><strong>fs/promises</strong> 提供了 Promise 操作方法</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { mkdir } from &#39;fs/promises&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>async function hd() {</span></span>
<span class="line"><span>  await mkdir(&#39;hd&#39;)</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>hd()</span></span></code></pre></div><h3 id="https-doc-houdunren-com-系统课程-node-8-fs-模块-html-删除目录-删除目录" tabindex="-1">[#](<a href="https://doc.houdunren.com/%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B/node/8" target="_blank" rel="noreferrer">https://doc.houdunren.com/系统课程/node/8</a> FS 模块.html#删除目录)删除目录 <a class="header-anchor" href="#https-doc-houdunren-com-系统课程-node-8-fs-模块-html-删除目录-删除目录" aria-label="Permalink to &quot;[#](https://doc.houdunren.com/系统课程/node/8 FS 模块.html#删除目录)删除目录&quot;">​</a></h3><p>使用 <strong>rmdirSync</strong> 以同步的方式删除多级目录，同步删除会阻塞代码，建议尽可能使用异步操作。</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { rmdirSync } from &#39;fs&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>rmdirSync(&#39;a&#39;, { recursive: true })</span></span></code></pre></div><p>使用 <strong>rmdir</strong> 异步删除目录，默认只能删除空目录</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { rmdir } from &#39;fs&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>rmdir(&#39;hd&#39;, (error) =&gt; {</span></span>
<span class="line"><span>  if (error) throw error</span></span>
<span class="line"><span>  console.log(&#39;目录删除成功&#39;)</span></span>
<span class="line"><span>})</span></span></code></pre></div><p>递归删除目录，即删除目录中的所有内容，可以删除非空目录</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { rmdir } from &#39;fs&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>rmdir(&#39;hd&#39;, { recursive: true }, (error) =&gt; {</span></span>
<span class="line"><span>  if (error) throw error</span></span>
<span class="line"><span>  console.log(&#39;目录删除成功&#39;)</span></span>
<span class="line"><span>})</span></span></code></pre></div><p><strong>fs/promises</strong> 提供了 Promise 操作方法，用于异步删除目录</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import { rmdir } from &#39;fs/promises&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>rmdir(&#39;hd&#39;)</span></span>
<span class="line"><span>  .then((e) =&gt; console.log(&#39;删除成功&#39;))</span></span>
<span class="line"><span>  .catch((error) =&gt; console.log(&#39;删除失败&#39;))</span></span></code></pre></div><p>下面是递归删除目录，非空目录也可以一次删除</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { rmdir } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rmdir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { recursive: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (error) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;目录删除成功&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div>`,79)]))}const E=a(t,[["render",l]]);export{c as __pageData,E as default};
